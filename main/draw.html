<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Drawings &#8212; pyadi-jif v0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8e8a900e" />
    <link rel="stylesheet" type="text/css" href="_static/app.min.css?v=47649d88" />
    <link rel="stylesheet" type="text/css" href="_static/css/style.css?v=632a43e7" />
    <script defer="" src="_static/app.umd.js?v=9e881883"></script>
    <link rel="icon" href="_static/favicon.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Developer documentation" href="developers.html" />
    <link rel="prev" title="JESD204 Reference" href="devs/jesd.html" />
   
  
  <meta name="repository" content="None">
  <meta name="version" content="">
  


<style>
  body {
    
  }

  body.dark {
    
  }

  @media (prefers-color-scheme: dark) {
    body:not(.light) {
      
    }
  }
</style>
  </head><body>
  <input type="checkbox" id="input-show-toc">
  <input type="checkbox" id="input-show-localtoc">
  <input type="checkbox" id="input-show-repotoc">

  
  <div class="search-area">
    <form action="" method="get">
      <input type="text" name="q" aria-labelledby="search-documentation" value="" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="search" placeholder="Search"/>
      <button class="icon"></button>
    </form>
  </div>
  

  <header>
    <div id="left">
      <label id="show-sidebar" class="icon" for="input-show-toc" title="Show/hide index"></label>
    </div>
    <div id="right">
      <span>
        <a id="logo-org" href="https://analog.com"></a>
        <div class="vertical-divider"></div>
        <label id="show-repotoc" for="input-show-repotoc" title="Show/hide docs" tabindex="0">Docs</label>
        <a id="logo" href="index.html">
          <div>pyadi-jif</div>
        </a>
      </span>
      <span class="reverse">
        <label id="show-localtoc" class="icon" for="input-show-localtoc" title="Show/hide contents"></label>
      </span>
    </div>
  </header>


  <div class="repotoc-tree overlay">
    <root/>

  </div>
    <div class="localtoc">
      <div class="tocwrapper">
        <div>
          <div class="localtoc-header"></div>
          <a id="scroll-up" href="#top-anchor" title="Back to top"></a>
        </div>
        <nav>
          <ul>
<li><a class="reference internal" href="#">Drawings</a><ul>
<li><a class="reference internal" href="#pre-requisites">Pre-requisites</a></li>
<li><a class="reference internal" href="#generating-diagrams">Generating diagrams</a><ul>
<li><a class="reference internal" href="#generating-system-diagrams">Generating System Diagrams</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </nav>
      </div>
    </div>

  
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
    <a id="logo" href="index.html">
      <img class="only-light" src="_static/imgs/PyADI-JIF_logo_cropped.png"/>
      <img class="only-dark" src="_static/imgs/PyADI-PyADI-JIF_logo_w_cropped.png"/>
    </a><input id="input-switch-toc" type="checkbox">
<label id="show-repotoc" for="input-switch-toc">
All content
</label>
<label id="show-toc" for="input-switch-toc">
Content on this topic
</label>
<div class="repotoc-tree">
  <root/>

</div>
<div class="toc-tree">
  <html>
  <body><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installing PyADI-JIF</a></li>
<li class="toctree-l1"><a class="reference internal" href="flow.html">Usage Flows</a></li>
<li class="toctree-l1"><a class="reference internal" href="converters.html">Data converters</a></li>
<li class="toctree-l1"><a class="reference internal" href="clocks.html">Clock chips</a></li>
<li class="toctree-l1"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-1" id="toctree-collapse-1"/><div class="collapse"><a class="reference internal" href="fpgas/index.html">FPGAs</a><label for="toctree-collapse-1"><div class="icon"></div></label></div><ul>
<li class="toctree-l2"><a class="reference internal" href="fpgas/fpgas.html">FPGA Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="fpgas/fpga_internal.html">FPGA Clocking</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="parts.html">Supported Parts</a></li>
<li class="toctree-l1"><a class="reference internal" href="defs.html">JESD204 Definitions</a></li>
<li class="toctree-l1"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-2" id="toctree-collapse-2"/><div class="collapse"><a class="reference internal" href="devs/index.html">Reference APIs</a><label for="toctree-collapse-2"><div class="icon"></div></label></div><ul>
<li class="toctree-l2"><a class="reference internal" href="devs/converters.html">Converter Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="devs/clocks.html">Clock Chip Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="devs/plls.html">PLLs Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="devs/fpga_ref.html">FPGA Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="devs/jesd.html">JESD204 Reference</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Drawings</a></li>
<li class="toctree-l1"><a class="reference internal" href="developers.html">Developer documentation</a></li>
</ul>
</body>
</html>

</div>
        </div>
      </div>

  <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper" id="top-anchor">
          
          <div class="body" role="main">
            
  <section id="drawings">
<h1>Drawings<a class="headerlink" href="#drawings" title="Link to this heading"></a></h1>
<p><strong>pyadi-jif</strong> has been extended to generate diagrams of the clock trees for components and systems. This is done using the <a class="reference external" href="https://d2lang.com/">d2lang</a> language.</p>
<section id="pre-requisites">
<h2>Pre-requisites<a class="headerlink" href="#pre-requisites" title="Link to this heading"></a></h2>
<p>To generate the diagrams, you will need to leverage the d2 interface support provided by <strong>pyadi-jif</strong>. This is done by either installing a pre-built wheel that contains the binaries or by building the d2lang interface from source.</p>
<p>To build the d2lang interface from source will require the go on your system. Once avaible run the build script to generate the interface library:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>adijif/d2
chmod<span class="w"> </span>+x<span class="w"> </span>build.sh
./build.sh
</pre></div>
</div>
<p>This will create a shared object library in the <code class="docutils literal notranslate"><span class="pre">adijif/d2</span></code> directory. This is the only requirement to generate diagrams.</p>
</section>
<section id="generating-diagrams">
<h2>Generating diagrams<a class="headerlink" href="#generating-diagrams" title="Link to this heading"></a></h2>
<p>Generating diagrams is done by calling the <code class="docutils literal notranslate"><span class="pre">draw</span></code> method on the system or component object. This will generate a diagram of the clock tree. Drawing is only valid once the component or system has been solved. Here is an example of generating a diagram for the AD9680 and dummy sources:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">adijif</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jif</span>

<span class="n">adc</span> <span class="o">=</span> <span class="n">jif</span><span class="o">.</span><span class="n">ad9680</span><span class="p">()</span>

<span class="c1"># Check static</span>
<span class="n">adc</span><span class="o">.</span><span class="n">validate_config</span><span class="p">()</span>

<span class="n">required_clocks</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">get_required_clocks</span><span class="p">()</span>
<span class="n">required_clock_names</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">get_required_clock_names</span><span class="p">()</span>

<span class="c1"># Add generic clock sources for solver</span>
<span class="n">clks</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">clock</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">required_clocks</span><span class="p">,</span> <span class="n">required_clock_names</span><span class="p">):</span>
    <span class="n">clk</span> <span class="o">=</span> <span class="n">jif</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">arb_source</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">adc</span><span class="o">.</span><span class="n">_add_equation</span><span class="p">(</span><span class="n">clk</span><span class="p">(</span><span class="n">adc</span><span class="o">.</span><span class="n">model</span><span class="p">)</span> <span class="o">==</span> <span class="n">clock</span><span class="p">)</span>
    <span class="n">clks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">clk</span><span class="p">)</span>

<span class="c1"># Solve</span>
<span class="n">solution</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">LogVerbosity</span><span class="o">=</span><span class="s2">&quot;Quiet&quot;</span><span class="p">)</span>
<span class="n">settings</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">get_config</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span>

<span class="c1"># Get clock values</span>
<span class="n">clock_values</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">clk</span> <span class="ow">in</span> <span class="n">clks</span><span class="p">:</span>
    <span class="n">clock_values</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">clk</span><span class="o">.</span><span class="n">get_config</span><span class="p">(</span><span class="n">solution</span><span class="p">))</span>
<span class="n">settings</span><span class="p">[</span><span class="s2">&quot;clocks&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">clock_values</span>

<span class="n">image_data</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;clocks&quot;</span><span class="p">])</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;ad9680_example.svg&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">image_data</span><span class="p">)</span>
</pre></div>
</div>
<p>This will generate a file called <code class="docutils literal notranslate"><span class="pre">ad9680_example.svg</span></code> in the current working directory. This file can be opened in any SVG viewer. The diagram will look similar to the one below:</p>
<figure class="align-default" id="ad9680-example">
<a class="reference internal image-reference" href="_images/ad9680_example.svg"><img alt="_images/ad9680_example.svg" src="_images/ad9680_example.svg" style="width: 80%;" />
</a>
</figure>
<section id="generating-system-diagrams">
<h3>Generating System Diagrams<a class="headerlink" href="#generating-system-diagrams" title="Link to this heading"></a></h3>
<p>The same process can be used to generate diagrams for systems. The only difference is that the system object must be used instead of the component object. Here is an example of generating a diagram for the AD9680 and AD9144:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">adijif</span>

<span class="n">vcxo</span> <span class="o">=</span> <span class="mi">125000000</span>

<span class="n">sys</span> <span class="o">=</span> <span class="n">adijif</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;ad9680&quot;</span><span class="p">,</span> <span class="s2">&quot;hmc7044&quot;</span><span class="p">,</span> <span class="s2">&quot;xilinx&quot;</span><span class="p">,</span> <span class="n">vcxo</span><span class="p">)</span>

<span class="c1"># Get Converter clocking requirements</span>
<span class="n">sys</span><span class="o">.</span><span class="n">converter</span><span class="o">.</span><span class="n">sample_clock</span> <span class="o">=</span> <span class="mf">1e9</span>
<span class="n">sys</span><span class="o">.</span><span class="n">converter</span><span class="o">.</span><span class="n">decimation</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">sys</span><span class="o">.</span><span class="n">converter</span><span class="o">.</span><span class="n">set_quick_configuration_mode</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mh">0x88</span><span class="p">))</span>
<span class="n">sys</span><span class="o">.</span><span class="n">converter</span><span class="o">.</span><span class="n">K</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">sys</span><span class="o">.</span><span class="n">Debug_Solver</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># Get FPGA clocking requirements</span>
<span class="n">sys</span><span class="o">.</span><span class="n">fpga</span><span class="o">.</span><span class="n">setup_by_dev_kit_name</span><span class="p">(</span><span class="s2">&quot;zc706&quot;</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">fpga</span><span class="o">.</span><span class="n">force_qpll</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">cfg</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;daq2_example.svg&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>This will generate a file called <code class="docutils literal notranslate"><span class="pre">daq2_example.svg</span></code> in the current working directory. This file can be opened in any SVG viewer. The diagram will look similar to the one below:</p>
<figure class="align-default" id="daq2-example">
<a class="reference internal image-reference" href="_images/daq2_example.svg"><img alt="_images/daq2_example.svg" src="_images/daq2_example.svg" style="width: 80%;" />
</a>
</figure>
</section>
</section>
</section>


          </div>
              <div class="related">
                &nbsp;
    <a href="devs/jesd.html" title="Previous document (Alt+Shift+LeftArrow)" class="prev">JESD204 Reference</a>
    <a href="developers.html" title="Next document (Alt+Shift+RightArrow)" class="next">Developer documentation</a>
              </div>
          
        </div>
      </div>
  </div>

  <label id="cancel-area-show-toc" for="input-show-toc"></label>
  <label id="cancel-area-show-localtoc" for="input-show-localtoc"></label>
    <footer>
      &#169;2020-2025, Analog Devices Inc.
      
      |
      Made with <a href="https://www.sphinx-doc.org/">Sphinx</a>
      &amp; <a href="https://github.com/analogdevicesinc/doctools">Doctools</a>
      
    </footer>
  </body>
</html>